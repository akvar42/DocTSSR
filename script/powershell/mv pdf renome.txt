#ce script extrait les fichier qui contiennent "Support de cours" dans leur nom et les renomes avec le noms du dossier qui les contiennent

# Définir le chemin du dossier source et du dossier de destination
$sourceDir = "C:\chemin\vers\le\dossier\source"
$destDir = "C:\chemin\vers\le\dossier\destination"

# Rechercher tous les fichiers .pdf, à l'exclusion des .zip, qui contiennent "Support de cours" dans leur nom
Get-ChildItem -Path $sourceDir -Recurse -File -Filter "*.pdf" | Where-Object { $_.Extension -ne ".zip" -and $_.Name -like "*Support de cours*" } | ForEach-Object {
    $dest = $destDir + $_.FullName.Substring($sourceDir.Length)
    $destFolder = Split-Path -Path $dest -Parent
    $folderName = Split-Path $_.Directory -Leaf
    $newFileName = "${folderName}_$($_.Name)"

    if (-not (Test-Path $destFolder)) {
        New-Item -Path $destFolder -ItemType Directory
    }

    $destFullPath = Join-Path -Path $destFolder -ChildPath $newFileName
    Copy-Item -Path $_.FullName -Destination $destFullPath
}

Write-Output "Copie et renommage terminés."
